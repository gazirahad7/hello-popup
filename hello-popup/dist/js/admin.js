(()=>{"use strict";document?.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("hello-popup-settings-form"),t=document.getElementById("hello-popup-settings-message");function o(e,t="success"){const o=document.getElementById("hello-toast-container");if(!o)return;const n=document.createElement("div");n.className="hello-toast","error"===t?n.style.backgroundColor="#dc3545":"success"===t?n.style.backgroundColor="#28a745":"info"===t&&(n.style.backgroundColor="#007bff"),n.textContent=e,o.appendChild(n),setTimeout((()=>{n.remove()}),3e3)}e?.addEventListener("submit",(async n=>{n.preventDefault(),t.textContent="Saving...",t.style.color="gray";const s=new FormData(e);try{const e=await fetch(ajaxurl,{method:"POST",body:s,credentials:"same-origin"}),n=await e.json();n.success?(t.textContent="Settings saved successfully!",t.style.color="green",o("Settings saved successfully!","success")):(t.textContent=n?.data?.message||"Failed to save settings.",t.style.color="red",o(n?.data?.message||"Failed to save settings.","error"))}catch(e){console.error("AJAX error:",e),t.textContent="An unexpected error occurred.",t.style.color="red",o("An unexpected error occurred.","error")}setTimeout((()=>{t.textContent=""}),3e3)}))})),document?.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("popup_image_button"),t=document.getElementById("popup_image_remove"),o=document.getElementById("popup_image_preview"),n=document.getElementById("hello_popup_image");let s;e?.addEventListener("click",(()=>{s||(s=wp.media({title:"Select or Upload Popup Image",button:{text:"Use this image"},multiple:!1}),s.on("select",(()=>{const c=s.state().get("selection").first().toJSON();o.src=c.url,o.style.display="block",t.style.display="block",n.value=c.url,e.textContent="Change Image"}))),s.open()})),t?.addEventListener("click",(()=>{o.src="",o.style.display="none",t.style.display="none",n.value="",e.textContent="Select Image"}));const c=document.getElementById("copy_trigger_class_btn"),l=document.getElementById("popup_trigger_class");c&&l&&c.addEventListener("click",(function(e){l.select(),l.setSelectionRange(0,99999),document.execCommand("copy");const t=c.textContent;c.textContent="Copied!",setTimeout((()=>{c.textContent=t}),1500)}));const a=document.getElementById("hello_popup_auto_show");a&&a.addEventListener("change",(()=>{a.checked||localStorage.removeItem("helloPopupClosedAt")}))}))})();